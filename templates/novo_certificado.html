{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h2>Novo Certificado</h2>
    
    <form method="POST" class="mt-4">
        <div class="form-group mb-3">
            <label for="razao_social">Razão Social</label>
            <input type="text" class="form-control" id="razao_social" name="razao_social" required>
        </div>
        
        <div class="form-group mb-3">
            <label for="nome_fantasia">Nome Fantasia</label>
            <input type="text" class="form-control" id="nome_fantasia" name="nome_fantasia" required>
        </div>
        
        <div class="form-group mb-3">
            <label for="cnpj">CNPJ</label>
            <input type="text" class="form-control" id="cnpj" name="cnpj" pattern="\d{2}\.\d{3}\.\d{3}/\d{4}-\d{2}" placeholder="00.000.000/0000-00" required>
            <small class="form-text text-muted">Formato: 00.000.000/0000-00</small>
        </div>
        
        <div class="form-group mb-3">
            <label for="telefone">Telefone para Contato</label>
            <input type="tel" class="form-control" id="telefone" name="telefone" pattern="\(\d{2}\) \d{4,5}-\d{4}" placeholder="(00) 00000-0000" required>
            <small class="form-text text-muted">Formato: (00) 00000-0000</small>
        </div>
        
        <div class="form-group mb-3">
            <label for="data_validade">Data de Validade</label>
            <input type="date" class="form-control" id="data_validade" name="data_validade" required>
            <small class="form-text text-muted">
                O status será definido automaticamente com base na data de validade:
                <ul>
                    <li>Expirado: quando a data de validade for anterior à data atual</li>
                    <li>Próximo ao Vencimento: quando faltar 30 dias ou menos para vencer</li>
                    <li>Válido: quando faltar mais de 30 dias para vencer</li>
                </ul>
            </small>
        </div>
        
        <div class="form-group mb-3">
            <label for="observacoes">Observações</label>
            <textarea class="form-control" id="observacoes" name="observacoes" rows="3"></textarea>
        </div>
        
        <div class="mt-4">
            <button type="submit" class="btn btn-primary">Salvar</button>
            <a href="{{ url_for('listar_certificados') }}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>

{% block scripts %}
<script>
// Máscara para CNPJ
document.getElementById('cnpj').addEventListener('input', function (e) {
    let x = e.target.value.replace(/\D/g, '').match(/(\d{0,2})(\d{0,3})(\d{0,3})(\d{0,4})(\d{0,2})/);
    e.target.value = !x[2] ? x[1] : x[1] + '.' + x[2] + '.' + x[3] + '/' + x[4] + (x[5] ? '-' + x[5] : '');
});

// Máscara para telefone
document.getElementById('telefone').addEventListener('input', function (e) {
    let x = e.target.value.replace(/\D/g, '').match(/(\d{0,2})(\d{0,5})(\d{0,4})/);
    e.target.value = !x[2] ? x[1] : '(' + x[1] + ') ' + x[2] + (x[3] ? '-' + x[3] : '');
});
</script>
{% endblock %}

{% endblock %} 